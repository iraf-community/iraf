# Make the PROTO package.

$call	relink
$exit

update:
	$call	relink
	$call	install
	;

relink:
	$set	LIBS = "-lxtools -liminterp -lbev -lgsurfit -lncar -lgks -lds"

	$update	libpkg.a
	$omake	x_proto.x
	$link	x_proto.o libpkg.a $(LIBS) -o xx_proto.e
	;

install:
	$move	xx_proto.e noaobin$x_proto.e
	;

tfiles:
	$set	GEN = "$$generic -k"

	$ifolder (fixcol.x,  fixcol.gx)  $(GEN) fixcol.gx  -o fixcol.x	$endif
	$ifolder (fixline.x, fixline.gx) $(GEN) fixline.gx -o fixline.x	$endif
	$ifolder (imfuncs.x, imfuncs.gx) $(GEN) imfuncs.gx -o imfuncs.x	$endif
	$ifolder (imrep.x,   imrep.gx)   $(GEN) imrep.gx   -o imrep.x	$endif
	;

libpkg.a:
	$ifeq (USE_GENERIC, yes) $call tfiles $endif
	@imedit
	@imexamine
	@ir
	@tvmark

	clnewimage.x	<imhdr.h>
	epix.x		<imhdr.h>
	fields.x	<ctype.h>
	fixcol.x	<imhdr.h> <imset.h>
	fixline.x	<imhdr.h> <imset.h>
	imfuncs.x	<imhdr.h>
	imfunction.x	<imhdr.h>
	imrep.x		<imhdr.h>
	interp.x	<fset.h>
	intrp.f
	t_bscale.x	<imhdr.h> <error.h> <time.h> <ctype.h>
	t_binfil.x	<mach.h> <error.h> <imhdr.h>
	t_binpairs.x	
	t_fixpix.x	<fset.h> <imhdr.h>
	t_imctroid.x	<imhdr.h> <error.h>
	t_imreplace.x	<imhdr.h>
	t_imscale.x	<imhdr.h> <mach.h>
	t_imslice.x	<imhdr.h> <fset.h> <error.h>
	t_imstack.x	<imhdr.h>
	t_imtitle.x	<imhdr.h>
	t_join.x
	t_mkhgm.x	<gset.h> <mach.h>
	t_mpc.x		<mach.h> <error.h> <gset.h> <imhdr.h>
	t_slitpic.x	<ctype.h> <imhdr.h> slitpic.h
	toonedspec.x	<error.h> <fset.h> <imhdr.h>
	;
