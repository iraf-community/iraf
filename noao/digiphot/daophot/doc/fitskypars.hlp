.help fitskypars Dec92 noao.digiphot.daophot
.ih
NAME
fitskypars - edit the sky fitting algorithm parameters
.ih
USAGE
fitskypars
.ih
PARAMETERS
.ls salgorithm = "mode"
The sky fitting algorithm to be employed. DAOPHOT users should
in general use the "mode" algorithm for best results in very
crowded fields. The sky fitting options are:
.ls constant
Use a user supplied constant value for sky.
.le
.ls file
Read sky values from a text file.
.le
.ls mean
Compute the mean of the sky pixel distribution.
.le
.ls median
Compute the median of the sky pixel distribution.
.le
.ls mode
Compute the mode of the sky pixel distribution.
.le
.ls centroid
Compute the intensity weighted mean (centroid) of the sky pixel histogram.
.le
.ls gauss
A Gaussian function is fit to the sky pixel histogram using nonlinear least
squares techniques.
.le
.ls ofilter
A variation of the optimal filtering technique using a triangular weighting
function is applied to the histogram of the sky pixels.
.le
.ls crosscor
The cross-correlation function of the pixel distribution and a Gaussian
noise function is used to compute the sky value.
.le
.ls histplot
The peak of the histogram of sky pixels is marked interactively by the
user on the graphics device.
.le
.ls radplot
The sky level can be marked interactively on a radial profile plot.
.le
.le
.ls annulus = 10.0  (scale units)
The inner radius of the annular sky fitting region in units of the
scale parameter.
.le
.ls dannulus = 10.0  (scale units)
The width of the annular sky fitting region in units of the scale parameter.
.le
.ls skyvalue = 0.0
The constant for constant sky subtraction.
.le
.ls smaxiter = 10
The maximum number of iterations performed by the sky fitting algorithm.
\fISmaxiter\fR is required by the gauss and ofilter sky fitting algorithms.
.le
.ls sloclip = 0.0, shiclip = 0.0 (percent)
The high and lo side clipping parameters in percent of the total number
of pixels. If either of these parameters > 0.0 then the specified
percentage of the pixels will be arbitrarily removed from the sky pixel
distribution before any sky fitting is done.
.le
.ls snreject = 50
The maximum number of pixel rejection cycles.
.le
.ls sloreject = 3.0, shireject = 3.0
The ksigma clipping factors for the pixel rejection  phase of the
sky fitting algorithm. \fISloreject\fR and \fIshireject\fR are
in units of the computed sky sigma.
.le
.ls khist = 3.0
The ksigma clipping factor for computing the histogram of the sky pixels.
\fIKhist\fR is in units of
sigma of the local sky pixel distribution.
The histogram will be 2.0 * khist * sigma wide.
.le
.ls binsize = 0.10
The width of a single bin of the histogram of sky values.
\fIBinsize\fR is in units of the sigma of the local sky pixel distribution.
.le
.ls smooth = no
Boxcar smooth the histogram before computing a sky value.
.le
.ls rgrow = 0.0  (scale units)
The region growing radius for pixel rejection in the sky region, in units
of \fIscale\fR. When a bad sky_pixel is detected, all pixels within
\fIrgrow / scale\fR will be rejected. If \fIrgrow\fR is 0.0 region growing
is not performed.
.le
.ls mksky = no
Mark the sky annuli on the displayed image ?
.le
.ih
DESCRIPTION
The sky fitting algorithm parameters control the action of the sky fitting
algorithms.  The default
values have been chosen for efficiency and to give reasonable results in
the majority of cases.
Note that many of the sky fitting parameters scale with two quantities which
are data dependent, the image scale,
\fIscale\fR, and the standard deviation of the local sky pixels.
The scale parameter is located in the DATAPARS task.

Using an initial position and \fIscale\fR supplied by the user, sky pixels
in an annular region of inner radius \fIannulus / scale\fR pixels and width
\fIdannulus / scale\fR pixels are extracted from the IRAF image.
Pixels outside the good data range specified by the DATAPARS task
parameters \fIdatamin\fR and \fIdatamax\fR are excluded from the sky
fit. \fISloclip\fR and \fIshiclip\fR percent of the pixels are also
removed from either end of the sky distribution before any fitting is
done.

If the \fIscale\fR parameter is defined in terms of the half width
at half maximum of the point spread function, then single values of
\fIannulus\fR and \fIdannulus\fR once chosen will work well for
for computing sky values in images of different seeing and
detector characteristics.

Sky values are computed using the sky fitting algorithm specified by
\fIsalgorithm\fR. The default value is \fImode\fR.
If \fIfitsky\fR = median or mode, FITSKY computes the the appropriate
sky value directly from the array of sky pixels.

The remaining sky fitting algorithms employ the histogram of the object sky
pixels. The computed histogram is 2.0 * \fIkhist\fR * sigma wide with
a bin width of \fIbinsize\fR * sigma. where sigma is the computed
standard deviation of the sky pixels.
If \fIsmooth\fR = yes, boxcar smoothing is performed on the computed
histogram before sky fitting.
The mode of the histogram is then computed by, a non-linear least squares
fit to a Gaussian (salgorithm = gauss), optimal filtering of the histogram
(salgorithm = ofilter), computing the centroid of the histogram 
(salgorithm = centroid) or by cross-correlation techniques 
(salgorithm = crosscor).

Two interactive methods of fitting sky are also available.
If \fIsalgorithm\fR is radplot or histplot, the user can interactively set
the value of the sky using the standard graphics device and
graphics cursor.

Pixels which deviate from the sky value by more than
\fIsloreject * skysigma\fR and \fIshireject\fR are rejected from the fit.
If \fIrgrow\fR > 0, pixels within a radius of
\fIrgrow / scale\fR of the rejected pixel are also rejected from
the fit.  The procedure iterates
until no more pixels are rejected, all pixels are rejected or
the maximum number of rejection cycles \fIsnreject\fR iterations is reached.

.ih
EXAMPLES

1. List the sky fitting parameters.

.nf
	da> lpar fitskypars
.fi

2. Edit the sky fitting parameters.

.nf
	da> fitskypars
.fi

3. Edit the FITSKYPARS parameters from with the PHOT task.

.nf
    da> epar phot

	... edit a few phot parameters

	... move to the fitskypars parameter and type :e

	... edit the fitskypars parameters and type :q

	... finish editing the phot parameters and type ^Z
.fi

4. Save the current FITSKYPARS parameter set in a text file skynite1.par.
This can also be done from inside a higher level task as in the
above example.

.nf
    da> epar fitskypars

	... type ":w skynite1.par"  from within epar
.fi
.ih
TIME REQUIREMENTS
.ih
BUGS
.ih
SEE ALSO
epar,datapars,phot
.endhelp
